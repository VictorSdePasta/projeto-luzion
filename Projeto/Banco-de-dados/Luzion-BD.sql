create database luzion;
use luzion;

create table Empresa (
  idEmpresa int primary key auto_increment,
  razaoSocial varchar(100) not null unique,
  nomeFantasia varchar(100) not null,
  cnpj char(11) not null unique,
  contrato tinyint
);

insert into Empresa (razaoSocial,nomeFantasia,cnpj,contrato) values
('facilitariamos a sua vida LTDA','Facilitariamos TUDO','00300300300',2),
('facilitando serviços LTDA','Facilitadores Impecaveis','00100100100',0),
('servicos felicity LTDA','Felicity em te ajudar','00200200200',1);

create table Cliente (
  idCliente int primary key auto_increment,
  razaoSocial varchar(100) not null unique,
  nomeFantasia varchar(100) not null,
  cnpj char(14) not null unique,
  fkEmpresa int not null,
  constraint fkClienteEmpresa foreign key (fkEmpresa) references Empresa(idEmpresa)
);

insert into Cliente (razaoSocial,nomeFantasia,cnpj,fkEmpresa) values
('SenGases LTDA','SenGas','00300300300',1),
('SmartsBeefs LTDA','SmartBeef','00400400400',1),
('Vegetal Temperature Transformation Technology LTDA','V3T','00500500500',2),
('Armory Safe LTDA','Armory Safe','00600600600',2),
('Neoguard LTDA','NeoGuard','00700700700',1),
('Shopping do bairro LTDA','Shopping do bairro','00800800800',2);

create table Endereco (
  idEndereco int primary key auto_increment,
  logradouro varchar(200),
  numero varchar(5),
  cep char(8),
  estado varchar(35),
  uf char(2)
);

insert into Endereco (logradouro,numero,cep,estado,uf) values
('Rua Sem Gas','412','01010100','São Paulo','SP'),
('Rua do gado','2450','02020200','São Paulo','SP'),
('Avenida Vegetal','120','03030300','São Paulo','SP'),
('Rua Armada','300','04040400','São Paulo','SP'),
('Avenida Segura','216','05050500','São Paulo','SP'),
('Avenida do Bairro','123','06060600','São Paulo','SP');

create table Filial (
  idFilial int primary key auto_increment,
  titulo varchar(100),
  fkCliente int,
  constraint fkFilialCliente foreign key (fkCliente) references Cliente(idCliente),
  fkEndereco int,
  constraint fkFilialEndereco foreign key (fkEndereco) references Endereco(idEndereco)
);

insert into Filial (titulo,fkCliente,fkEndereco) values
('Sede SenGas',1,1),
('Sede SmartBeef',2,2),
('Sede V3T',3,3),
('Sede SenGas',4,4),
('Sede SenGas',5,5),
('Shopping do Bairro',6,6);

create table Funcionario (
  idFuncionario int primary key auto_increment,
  nome varchar(100) not null,
  email varchar(100) not null unique,
  senha varchar(255) not null,
  telefone varchar(11),
  nivelPermissao tinyint,
  fkFilial int not null,
  constraint fkFuncionarioFilial foreign key (fkFilial) references Filial(idFilial)
);

insert into Funcionario (nome,email,senha,telefone,nivelPermissao,fkFilial) values
('Ana Luiza','ana.lu@facilitando.com','analu123','11010101000',1,1),
('Daner Quispe','daner.qu@facilitando.com','danerqu123','11020202000',2,1),
('Igor Dias','igor.di@facilitando.com','igordi123','11030303000',3,1),
('Reginaldo De Souza','reginaldo.so@felicity.com','reginaldoso123','11040404000',1,2),
('Victor David','victor.da@felicity.com','victorda123','11050505000',2,2),
('Victor Silva','victor.si@felicity.com','victorsi123','11060606000',3,2);

create table PapelHigienico (
  idPapelHigienico int primary key auto_increment,
  modelo varchar(45),
  diametroExternoMM int,
  diametroInternoMM int,
  larguraMM int
);

insert into PapelHigienico (modelo, diametroExternoMM, diametroInternoMM, larguraMM) values
('Comum',10,4,10),
('Jumbo',10,4,10),
('Folha Dupla',12,5,10);

create table Estoque (
	idEstoque int auto_increment,
  fkPapelHigienico int,
  titulo varchar(100),
  altura int,
  largura int,
  profundidade int,
  percAtual int,
  fkFilial int,
  constraint fkEstoqueFilial foreign key (fkFilial) references Filial(idFilial),
  constraint fkPapelEstoque foreign key (fkPapelHigienico) references PapelHigienico(idPapelHigienico),
  primary key(idEstoque, fkPapelHigienico)
);

insert into Estoque (titulo,altura,largura,profundidade,fkFilial,fkPapelHigienico) values
('Galpão Ala A',3200,1400,1200,1,1),
('Galpão Terreo',2100,2200,1200,2,1),
('Galpão 12',3120,2000,1200,3,2),
('Estoque',2900,3200,1000,4,2),
('Galpão Ala B',2850,1200,2100,5,3),
('Galpão 1',3810,2200,1300,6,3);

create table Banheiro (
  idBanheiro int primary key auto_increment,
  titulo varchar(100),
  setor varchar(100),
  fkFilial int,
  constraint fkBanheiroFilial foreign key (fkFilial) references Filial(idFilial)
);

insert into Banheiro (titulo, setor, fkFilial) values
('Ala Sul','Terreo',1),
('Ala Sul', 'Terreo', 2),
('Ala Norte','Terreo',3),
('Ala Norte','Terreo',4),
('Ala Norte','Terreo',5),
('Ala Leste','Terreo',6),
('Ala Leste', 'Terreo',6),
('Ala Oeste','Terreo',6),
('1','Andar 1',1),
('2','Andar 1',2),
('3','Andar 1',3),
('1','Andar 2',2),
('1','Andar 2',3),
('1','Andar 2 - Funcionarios',6),
('2','Andar 2 - Publico',6),
('1','Andar 3',6);

create table Dispenser (
  idDispenser int primary key auto_increment,
  identificacao varchar(100),
  fkBanheiro int,
  constraint fkDispenserBanheiro foreign key (fkBanheiro) references Banheiro(idBanheiro),
  fkPapelHigienico int,
    constraint fkPapelDispenser foreign key (fkPapelHigienico) references PapelHigienico(idPapelHigienico)
);

insert into Dispenser (identificacao,fkBanheiro,fkPapelHigienico) values
('Cabine 1',1,1),
('Cabine 2',1,1),
('Cabine 3',1,1),
('Cabine 1',2,1),
('Cabine 2',2,1),
('Cabine 3',2,1),
('Cabine 4',2,1),
('Banheiro 1',3,2),
('Banheiro 2',3,2),
('Banheiro 3',3,2),
('Banheiro 4',3,2),
('Banheiro 5',3,2),
('Cabine 1',4,2),
('Cabine 2',4,2),
('Dispenser Geral',5,2),
('Cabine 1',6,2),
('Cabine 2',6,2),
('Cabine 3',6,2),
('Cabine 4',6,2),
('Cabine 5',6,2),
('Cabine 1',7,2),
('Cabine 2',7,2),
('Cabine 3',7,2),
('Cabine 4',7,2),
('Cabine 5',7,2),
('Cabine 1',8,2),
('Cabine 2',8,2),
('Cabine 3',8,2),
('Cabine 4',8,2),
('Cabine 5',8,2),
('Cabine 1',9,2),
('Cabine 2',9,2),
('Cabine 3',9,2),
('Cabine 1',10,2),
('Cabine 2',10,2),
('Banheiro 1',11,3),
('Banheiro 2',11,3),
('Banheiro 3',11,3),
('Cabine 1',12,1),
('Cabine 2',12,1),
('Banheiro 1',13,3),
('Banheiro 2',13,3),
('Banheiro 3',13,3),
('Cabine 1',14,2),
('Cabine 2',14,2),
('Cabine 3',14,2),
('Cabine 4',14,2),
('Cabine 1',15,2),
('Cabine 2',15,2),
('Cabine 3',15,2),
('Cabine 4',15,2),
('Cabine 5',15,2),
('Cabine 1',16,2),
('Cabine 2',16,2),
('Cabine 3',16,2),
('Cabine 4',16,2);

create table Registro (
  idRegistro int primary key auto_increment,
  valor int,
  dtRegistro datetime default current_timestamp,
  fkDispenser int,
  fkEstoque int,
  constraint fkRegistroEstoque foreign key (fkEstoque) references Estoque(idEstoque),
  constraint fkRegistroDispenser foreign key (fkDispenser) references Dispenser(idDispenser)
);

insert into Registro (valor,dtRegistro,fkEstoque) values
(1200,'2025-09-20 08:00:00',1),
(1320,'2025-09-20 08:00:00',2),
(1110,'2025-09-20 08:00:00',3),
(980,'2025-09-20 08:00:00',4),
(1100,'2025-09-20 08:00:00',5),
(1210,'2025-09-20 08:00:00',6);

insert into Registro (valor,dtRegistro,fkDispenser) values
(8, '2025-09-20 08:00:00', 1),
(8, '2025-09-20 12:00:00', 1),
(8, '2025-09-20 16:00:00', 1),
(8, '2025-09-20 20:00:00', 1),
(8, '2025-09-21 08:00:00', 1),
(8, '2025-09-21 08:00:00', 2),
(8, '2025-09-21 12:00:00', 2),
(8, '2025-09-21 16:00:00', 2),
(8, '2025-09-21 20:00:00', 2),
(8, '2025-09-22 08:00:00', 2),
(8, '2025-09-22 08:00:00', 3),
(8, '2025-09-22 12:00:00', 3),
(8, '2025-09-22 16:00:00', 3),
(8, '2025-09-22 20:00:00', 3),
(8, '2025-09-23 08:00:00', 3),
(8, '2025-09-23 08:00:00', 4),
(8, '2025-09-23 12:00:00', 4),
(8, '2025-09-23 16:00:00', 4),
(8, '2025-09-23 20:00:00', 4),
(8, '2025-09-24 08:00:00', 4),
(8, '2025-09-24 08:00:00', 5),
(8, '2025-09-24 12:00:00', 5),
(8, '2025-09-24 16:00:00', 5),
(8, '2025-09-24 20:00:00', 5),
(8, '2025-09-25 08:00:00', 5),
(8, '2025-09-25 08:00:00', 6),
(8, '2025-09-25 12:00:00', 6),
(8, '2025-09-25 16:00:00', 6),
(8, '2025-09-25 20:00:00', 6),
(8, '2025-09-26 08:00:00', 6),
(8, '2025-09-26 08:00:00', 7),
(8, '2025-09-26 12:00:00', 7),
(8, '2025-09-26 16:00:00', 7),
(8, '2025-09-26 20:00:00', 7),
(8, '2025-09-27 08:00:00', 7),
(8, '2025-09-27 08:00:00', 8),
(8, '2025-09-27 12:00:00', 8),
(8, '2025-09-27 16:00:00', 8),
(8, '2025-09-27 20:00:00', 8),
(8, '2025-09-28 08:00:00', 8),
(8, '2025-09-28 08:00:00', 9),
(8, '2025-09-28 12:00:00', 9),
(8, '2025-09-28 16:00:00', 9),
(8, '2025-09-28 20:00:00', 9),
(8, '2025-09-29 08:00:00', 9),
(8, '2025-09-29 08:00:00', 10),
(8, '2025-09-29 12:00:00', 10),
(8, '2025-09-29 16:00:00', 10),
(8, '2025-09-29 20:00:00', 10),
(8, '2025-09-30 08:00:00', 10),
(8, '2025-09-30 08:00:00', 11),
(8, '2025-09-30 12:00:00', 11),
(8, '2025-09-30 16:00:00', 11),
(8, '2025-09-30 20:00:00', 11),
(8, '2025-10-01 08:00:00', 11),
(8, '2025-10-01 08:00:00', 12),
(8, '2025-10-01 12:00:00', 12),
(8, '2025-10-01 16:00:00', 12),
(8, '2025-10-01 20:00:00', 12),
(8, '2025-10-02 08:00:00', 12),
(8, '2025-10-02 08:00:00', 13),
(8, '2025-10-02 12:00:00', 13),
(8, '2025-10-02 16:00:00', 13),
(8, '2025-10-02 20:00:00', 13),
(8, '2025-10-03 08:00:00', 13),
(8, '2025-10-03 08:00:00', 14),
(8, '2025-10-03 12:00:00', 14),
(8, '2025-10-03 16:00:00', 14),
(8, '2025-10-03 20:00:00', 14),
(8, '2025-10-04 08:00:00', 14),
(8, '2025-10-04 08:00:00', 15),
(8, '2025-10-04 12:00:00', 15),
(8, '2025-10-04 16:00:00', 15),
(8, '2025-10-04 20:00:00', 15),
(8, '2025-10-05 08:00:00', 15),
(8, '2025-10-05 08:00:00', 16),
(8, '2025-10-05 12:00:00', 16),
(8, '2025-10-05 16:00:00', 16),
(8, '2025-10-05 20:00:00', 16),
(8, '2025-10-06 08:00:00', 16),
(8, '2025-10-06 08:00:00', 17),
(8, '2025-10-06 12:00:00', 17),
(8, '2025-10-06 16:00:00', 17),
(8, '2025-10-06 20:00:00', 17),
(8, '2025-10-07 08:00:00', 17),
(8, '2025-10-07 08:00:00', 18),
(8, '2025-10-07 12:00:00', 18),
(8, '2025-10-07 16:00:00', 18),
(8, '2025-10-07 20:00:00', 18),
(8, '2025-10-08 08:00:00', 18),
(8, '2025-10-08 08:00:00', 19),
(8, '2025-10-08 12:00:00', 19),
(8, '2025-10-08 16:00:00', 19),
(8, '2025-10-08 20:00:00', 19),
(8, '2025-10-09 08:00:00', 19),
(8, '2025-10-09 08:00:00', 20),
(8, '2025-10-09 12:00:00', 20),
(8, '2025-10-09 16:00:00', 20),
(8, '2025-10-09 20:00:00', 20),
(8, '2025-10-10 08:00:00', 20),
(8, '2025-10-10 08:00:00', 21),
(8, '2025-10-10 12:00:00', 21),
(8, '2025-10-10 16:00:00', 21),
(8, '2025-10-10 20:00:00', 21),
(8, '2025-10-11 08:00:00', 21),
(8, '2025-10-11 08:00:00', 22),
(8, '2025-10-11 12:00:00', 22),
(8, '2025-10-11 16:00:00', 22),
(8, '2025-10-11 20:00:00', 22),
(8, '2025-10-12 08:00:00', 22),
(8, '2025-10-12 08:00:00', 23),
(8, '2025-10-12 12:00:00', 23),
(8, '2025-10-12 16:00:00', 23),
(8, '2025-10-12 20:00:00', 23),
(8, '2025-10-13 08:00:00', 23),
(8, '2025-10-13 08:00:00', 24),
(8, '2025-10-13 12:00:00', 24),
(8, '2025-10-13 16:00:00', 24),
(8, '2025-10-13 20:00:00', 24),
(8, '2025-10-14 08:00:00', 24),
(8, '2025-10-14 08:00:00', 25),
(8, '2025-10-14 12:00:00', 25),
(8, '2025-10-14 16:00:00', 25),
(8, '2025-10-14 20:00:00', 25),
(8, '2025-10-15 08:00:00', 25),
(8, '2025-10-15 08:00:00', 26),
(8, '2025-10-15 12:00:00', 26),
(8, '2025-10-15 16:00:00', 26),
(8, '2025-10-15 20:00:00', 26),
(8, '2025-10-16 08:00:00', 26),
(8, '2025-10-16 08:00:00', 27),
(8, '2025-10-16 12:00:00', 27),
(8, '2025-10-16 16:00:00', 27),
(8, '2025-10-16 20:00:00', 27),
(8, '2025-10-17 08:00:00', 27),
(8, '2025-10-17 08:00:00', 28),
(8, '2025-10-17 12:00:00', 28),
(8, '2025-10-17 16:00:00', 28),
(8, '2025-10-17 20:00:00', 28),
(8, '2025-10-18 08:00:00', 28),
(8, '2025-10-18 08:00:00', 29),
(8, '2025-10-18 12:00:00', 29),
(8, '2025-10-18 16:00:00', 29),
(8, '2025-10-18 20:00:00', 29),
(8, '2025-10-19 08:00:00', 29),
(8, '2025-10-19 08:00:00', 30),
(8, '2025-10-19 12:00:00', 30),
(8, '2025-10-19 16:00:00', 30),
(8, '2025-10-19 20:00:00', 30),
(8, '2025-10-20 08:00:00', 30),
(8, '2025-10-20 08:00:00', 31),
(8, '2025-10-20 12:00:00', 31),
(8, '2025-10-20 16:00:00', 31),
(8, '2025-10-20 20:00:00', 31),
(8, '2025-10-21 08:00:00', 31),
(8, '2025-10-21 08:00:00', 32),
(8, '2025-10-21 12:00:00', 32),
(8, '2025-10-21 16:00:00', 32),
(8, '2025-10-21 20:00:00', 32),
(8, '2025-10-22 08:00:00', 32),
(8, '2025-10-22 08:00:00', 33),
(8, '2025-10-22 12:00:00', 33),
(8, '2025-10-22 16:00:00', 33),
(8, '2025-10-22 20:00:00', 33),
(8, '2025-10-23 08:00:00', 33),
(8, '2025-10-23 08:00:00', 34),
(8, '2025-10-23 12:00:00', 34),
(8, '2025-10-23 16:00:00', 34),
(8, '2025-10-23 20:00:00', 34),
(8, '2025-10-24 08:00:00', 34),
(8, '2025-10-24 08:00:00', 35),
(8, '2025-10-24 12:00:00', 35),
(8, '2025-10-24 16:00:00', 35),
(8, '2025-10-24 20:00:00', 35),
(8, '2025-10-25 08:00:00', 35),
(8, '2025-10-25 08:00:00', 36),
(8, '2025-10-25 12:00:00', 36),
(8, '2025-10-25 16:00:00', 36),
(8, '2025-10-25 20:00:00', 36),
(8, '2025-10-26 08:00:00', 36),
(8, '2025-10-26 08:00:00', 37),
(8, '2025-10-26 12:00:00', 37),
(8, '2025-10-26 16:00:00', 37),
(8, '2025-10-26 20:00:00', 37),
(8, '2025-10-27 08:00:00', 37),
(8, '2025-10-27 08:00:00', 38),
(8, '2025-10-27 12:00:00', 38),
(8, '2025-10-27 16:00:00', 38),
(8, '2025-10-27 20:00:00', 38),
(8, '2025-10-28 08:00:00', 38),
(8, '2025-10-28 08:00:00', 39),
(8, '2025-10-28 12:00:00', 39),
(8, '2025-10-28 16:00:00', 39),
(8, '2025-10-28 20:00:00', 39),
(8, '2025-10-29 08:00:00', 39),
(8, '2025-10-29 08:00:00', 40),
(8, '2025-10-29 12:00:00', 40),
(8, '2025-10-29 16:00:00', 40),
(8, '2025-10-29 20:00:00', 40),
(8, '2025-10-30 08:00:00', 40),
(8, '2025-10-30 08:00:00', 41),
(8, '2025-10-30 12:00:00', 41),
(8, '2025-10-30 16:00:00', 41),
(8, '2025-10-30 20:00:00', 41),
(8, '2025-10-31 08:00:00', 41),
(8, '2025-10-31 08:00:00', 42),
(8, '2025-10-31 12:00:00', 42),
(8, '2025-10-31 16:00:00', 42),
(8, '2025-10-31 20:00:00', 42),
(8, '2025-11-01 08:00:00', 42),
(8, '2025-11-01 08:00:00', 43),
(8, '2025-11-01 12:00:00', 43),
(8, '2025-11-01 16:00:00', 43),
(8, '2025-11-01 20:00:00', 43),
(8, '2025-11-02 08:00:00', 43),
(8, '2025-11-02 08:00:00', 44),
(8, '2025-11-02 12:00:00', 44),
(8, '2025-11-02 16:00:00', 44),
(8, '2025-11-02 20:00:00', 44),
(8, '2025-11-03 08:00:00', 44),
(8, '2025-11-03 08:00:00', 45),
(8, '2025-11-03 12:00:00', 45),
(8, '2025-11-03 16:00:00', 45),
(8, '2025-11-03 20:00:00', 45),
(8, '2025-11-04 08:00:00', 45),
(8, '2025-11-04 08:00:00', 46),
(8, '2025-11-04 12:00:00', 46),
(8, '2025-11-04 16:00:00', 46),
(8, '2025-11-04 20:00:00', 46),
(8, '2025-11-05 08:00:00', 46),
(8, '2025-11-05 08:00:00', 47),
(8, '2025-11-05 12:00:00', 47),
(8, '2025-11-05 16:00:00', 47),
(8, '2025-11-05 20:00:00', 47),
(8, '2025-11-06 08:00:00', 47),
(8, '2025-11-06 08:00:00', 48),
(8, '2025-11-06 12:00:00', 48),
(8, '2025-11-06 16:00:00', 48),
(8, '2025-11-06 20:00:00', 48),
(8, '2025-11-07 08:00:00', 48),
(8, '2025-11-07 08:00:00', 49),
(8, '2025-11-07 12:00:00', 49),
(8, '2025-11-07 16:00:00', 49),
(8, '2025-11-07 20:00:00', 49),
(8, '2025-11-08 08:00:00', 49),
(8, '2025-11-08 08:00:00', 50),
(8, '2025-11-08 12:00:00', 50),
(8, '2025-11-08 16:00:00', 50),
(8, '2025-11-08 20:00:00', 50),
(8, '2025-11-09 08:00:00', 50),
(8, '2025-11-09 08:00:00', 51),
(8, '2025-11-09 12:00:00', 51),
(8, '2025-11-09 16:00:00', 51),
(8, '2025-11-09 20:00:00', 51),
(8, '2025-11-10 08:00:00', 51),
(8, '2025-11-10 08:00:00', 52),
(8, '2025-11-10 12:00:00', 52),
(8, '2025-11-10 16:00:00', 52),
(8, '2025-11-10 20:00:00', 52),
(8, '2025-11-11 08:00:00', 52),
(8, '2025-11-11 08:00:00', 53),
(8, '2025-11-11 12:00:00', 53),
(8, '2025-11-11 16:00:00', 53),
(8, '2025-11-11 20:00:00', 53),
(8, '2025-11-12 08:00:00', 53),
(8, '2025-11-12 08:00:00', 54),
(8, '2025-11-12 12:00:00', 54),
(8, '2025-11-12 16:00:00', 54),
(8, '2025-11-12 20:00:00', 54),
(8, '2025-11-13 08:00:00', 54),
(8, '2025-11-13 08:00:00', 55),
(8, '2025-11-13 12:00:00', 55),
(8, '2025-11-13 16:00:00', 55),
(8, '2025-11-13 20:00:00', 55),
(8, '2025-11-14 08:00:00', 55),
(8, '2025-11-14 08:00:00', 56),
(8, '2025-11-14 12:00:00', 56),
(8, '2025-11-14 16:00:00', 56),
(8, '2025-11-14 20:00:00', 56),
(8, '2025-11-15 08:00:00', 56);

select e.nomeFantasia as Empresa,
  c.nomeFantasia as 'Empresa Cliente',
  fl.titulo as Filial,
  fun.nome as Funcionario,
  fun.email as 'E-mail',
  fun.telefone as Contato
from Empresa as e join Cliente as c on c.fkEmpresa = e.idEmpresa
join Filial as fl on c.idCliente = fl.fkCliente
join Funcionario as fun on fl.idFilial = fun.fkFilial;

select e.nomeFantasia as Empresa,
  e.nomeFantasia as 'Empresa Cliente',
  fl.titulo as 'Filial'
from Empresa as e join Cliente as c on idEmpresa = fkEmpresa join Filial as fl on fkCliente = idCliente;

select titulo, concat(logradouro, ' ', numero, ' - CEP: ', cep) as Endereço from Filial join Endereco on fkEndereco = idFilial;

select identificacao as Dispenser,
b.titulo as 'Banheiro',
b.setor as 'Setor',
Filial.titulo as 'Empresa contratante',   
valor as 'Percentual de consumo', 
dtRegistro as 'Data de registro' 
from Registro
	join Dispenser on fkDispenser = idDispenser
    join Banheiro as b on fkFilial = idBanheiro
    join Filial on fkfilial = idFilial
    join Cliente on fkCliente = idCliente
    join Empresa on fkEmpresa = idEmpresa
  where Empresa.nomeFantasia = 'Facilitariamos TUDO';
  