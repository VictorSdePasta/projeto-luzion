-- Active: 1757607581749@@localhost@3306@luzion
create database luzion;
use luzion;

create table Facility (
  idFacility int primary key auto_increment,
  razaoSocial varchar(100) not null unique,
  nomeFantasia varchar(100) not null,
  cnpj char(11) not null unique
);

insert into Facility (razaoSocial,nomeFantasia,cnpj) values
('facilitando serviços LTDA','Facilitadores Impecaveis','00100100100'),
('servicos felicity LTDA','Felicity em te ajudar','00200200200');

create table Funcionario (
  idFuncionario int primary key auto_increment,
  nome varchar(100) not null,
  email varchar(100) not null unique,
  senha varchar(255) not null,
  telefone varchar(11),
  nivelPermissao tinyint,
  fkFacility int not null,
  constraint fkFuncionarioFacility foreign key (fkFacility) references Facility(idFacility)
);

insert into Funcionario (nome,email,senha,telefone,nivelPermissao,fkFacility) values
('Ana Luiza','ana.lu@facilitando.com','analu123','11010101000',1,1),
('Daner Quispe','daner.qu@facilitando.com','danerqu123','11020202000',2,1),
('Igor Dias','igor.di@facilitando.com','igordi123','11030303000',3,1),
('Reginaldo De Souza','reginaldo.so@felicity.com','reginaldoso123','11040404000',1,2),
('Victor David','victor.da@felicity.com','victorda123','11050505000',2,2),
('Victor Silva','victor.si@felicity.com','victorsi123','11060606000',3,2);

create table Empresa (
  idEmpresa int primary key auto_increment,
  razaoSocial varchar(100) not null unique,
  nomeFantasia varchar(100) not null,
  cnpj char(14) not null unique,
  fkFacility int not null,
  constraint fkEmpresaFacility foreign key (fkFacility) references Facility(idFacility)
);

insert into Empresa (razaoSocial,nomeFantasia,cnpj,fkFacility) values
('SenGases LTDA','SenGas','00300300300',1),
('SmartsBeefs LTDA','SmartBeef','00400400400',1),
('Vegetal Temperature Transformation Technology LTDA','V3T','00500500500',2),
('Armory Safe LTDA','Armory Safe','00600600600',2),
('Neoguard LTDA','NeoGuard','00700700700',1),
('Shopping do bairro LTDA','Shopping do bairro','00800800800',2);

create table Filial (
  idFilial int primary key auto_increment,
  titulo varchar(100),
  fkEmpresa int,
  constraint fkFilialEmpresa foreign key (fkEmpresa) references Empresa(idEmpresa)
);

insert into Filial (titulo,fkEmpresa) values
('Sede SenGas',1),
('Sede SmartBeef',2),
('Sede V3T',3),
('Sede SenGas',4),
('Sede SenGas',5),
('Shopping do Bairro',6);

create table Endereco (
  idEndereco int primary key auto_increment,
  logradouro varchar(200),
  numero varchar(5),
  cep char(8),
  estado varchar(35),
  uf char(2),
  fkFilial int,
  constraint fkEnderecoFilial foreign key (fkFilial) references Filial(idFilial)
);

insert into Endereco (logradouro,numero,cep,estado,uf,fkFilial) values
('Rua Sem Gas','412','01010100','São Paulo','SP',1),
('Rua do gado','2450','02020200','São Paulo','SP',2),
('Avenida Vegetal','120','03030300','São Paulo','SP',3),
('Rua Armada','300','04040400','São Paulo','SP',4),
('Avenida Segura','216','05050500','São Paulo','SP',5),
('Avenida do Bairro','123','06060600','São Paulo','SP',6);

create table Banheiro (
  idBanheiro int primary key auto_increment,
  titulo varchar(100),
  fkFilial int,
  constraint fkBanheiroFilial foreign key (fkFilial) references Filial(idFilial)
);

insert into Banheiro (titulo,fkFilial) values
('Terreo',1),
('Terreo',2),
('Terreo',3),
('Terreo',4),
('Terreo',5),
('Terreo 1',6),
('Terreo 2',6),
('Terreo 3',6),
('Andar 1',1),
('Andar 1',2),
('Andar 1',3),
('Andar 2',2),
('Andar 2',3),
('Andar 2 - Funcionarios',6),
('Andar 2 - Publico',6),
('Andar 3',6);

create table Dispenser (
  idDispenser int primary key auto_increment,
  identificacao varchar(100),
  fkBanheiro int,
  constraint fkDispenserBanheiro foreign key (fkBanheiro) references Banheiro(idBanheiro)
);

insert into Dispenser (identificacao,fkBanheiro) values
('Cabine 1',1),
('Cabine 2',1),
('Cabine 3',1),
('Cabine 1',2),
('Cabine 2',2),
('Cabine 3',2),
('Cabine 4',2),
('Banheiro 1',3),
('Banheiro 2',3),
('Banheiro 3',3),
('Banheiro 4',3),
('Banheiro 5',3),
('Cabine 1',4),
('Cabine 2',4),
('Dispenser Geral',5),
('Cabine 1',6),
('Cabine 2',6),
('Cabine 3',6),
('Cabine 4',6),
('Cabine 5',6),
('Cabine 1',7),
('Cabine 2',7),
('Cabine 3',7),
('Cabine 4',7),
('Cabine 5',7),
('Cabine 1',8),
('Cabine 2',8),
('Cabine 3',8),
('Cabine 4',8),
('Cabine 5',8),
('Cabine 1',9),
('Cabine 2',9),
('Cabine 3',9),
('Cabine 1',10),
('Cabine 2',10),
('Banheiro 1',11),
('Banheiro 2',11),
('Banheiro 3',11),
('Cabine 1',12),
('Cabine 2',12),
('Banheiro 1',13),
('Banheiro 2',13),
('Banheiro 3',13),
('Cabine 1',14),
('Cabine 2',14),
('Cabine 3',14),
('Cabine 4',14),
('Cabine 1',15),
('Cabine 2',15),
('Cabine 3',15),
('Cabine 4',15),
('Cabine 5',15),
('Cabine 1',16),
('Cabine 2',16),
('Cabine 3',16),
('Cabine 4',16);

create table Registro (
  idRegistro int primary key auto_increment,
  valor tinyint,
  dtRegistro datetime default current_timestamp,
  fkDispenser int,
  constraint fkRegistroDispenser foreign key (fkDispenser) references Dispenser(idDispenser)
);

insert into Registro (valor,dtRegistro,fkDispenser) values
(41, '2025-09-20 08:00:00', 1),
(83, '2025-09-20 12:00:00', 1),
(79, '2025-09-20 16:00:00', 1),
(90, '2025-09-20 20:00:00', 1),
(18, '2025-09-21 08:00:00', 1),
(62, '2025-09-21 08:00:00', 2),
(2, '2025-09-21 12:00:00', 2),
(7, '2025-09-21 16:00:00', 2),
(68, '2025-09-21 20:00:00', 2),
(55, '2025-09-22 08:00:00', 2),
(35, '2025-09-22 08:00:00', 3),
(68, '2025-09-22 12:00:00', 3),
(90, '2025-09-22 16:00:00', 3),
(67, '2025-09-22 20:00:00', 3),
(33, '2025-09-23 08:00:00', 3),
(81, '2025-09-23 08:00:00', 4),
(20, '2025-09-23 12:00:00', 4),
(35, '2025-09-23 16:00:00', 4),
(96, '2025-09-23 20:00:00', 4),
(36, '2025-09-24 08:00:00', 4),
(94, '2025-09-24 08:00:00', 5),
(4, '2025-09-24 12:00:00', 5),
(71, '2025-09-24 16:00:00', 5),
(37, '2025-09-24 20:00:00', 5),
(76, '2025-09-25 08:00:00', 5),
(35, '2025-09-25 08:00:00', 6),
(3, '2025-09-25 12:00:00', 6),
(53, '2025-09-25 16:00:00', 6),
(91, '2025-09-25 20:00:00', 6),
(12, '2025-09-26 08:00:00', 6),
(78, '2025-09-26 08:00:00', 7),
(80, '2025-09-26 12:00:00', 7),
(38, '2025-09-26 16:00:00', 7),
(80, '2025-09-26 20:00:00', 7),
(96, '2025-09-27 08:00:00', 7),
(93, '2025-09-27 08:00:00', 8),
(34, '2025-09-27 12:00:00', 8),
(48, '2025-09-27 16:00:00', 8),
(92, '2025-09-27 20:00:00', 8),
(20, '2025-09-28 08:00:00', 8),
(49, '2025-09-28 08:00:00', 9),
(90, '2025-09-28 12:00:00', 9),
(67, '2025-09-28 16:00:00', 9),
(12, '2025-09-28 20:00:00', 9),
(28, '2025-09-29 08:00:00', 9),
(28, '2025-09-29 08:00:00', 10),
(97, '2025-09-29 12:00:00', 10),
(40, '2025-09-29 16:00:00', 10),
(69, '2025-09-29 20:00:00', 10),
(6, '2025-09-30 08:00:00', 10),
(34, '2025-09-30 08:00:00', 11),
(71, '2025-09-30 12:00:00', 11),
(77, '2025-09-30 16:00:00', 11),
(13, '2025-09-30 20:00:00', 11),
(4, '2025-10-01 08:00:00', 11),
(28, '2025-10-01 08:00:00', 12),
(32, '2025-10-01 12:00:00', 12),
(37, '2025-10-01 16:00:00', 12),
(99, '2025-10-01 20:00:00', 12),
(72, '2025-10-02 08:00:00', 12),
(56, '2025-10-02 08:00:00', 13),
(52, '2025-10-02 12:00:00', 13),
(26, '2025-10-02 16:00:00', 13),
(31, '2025-10-02 20:00:00', 13),
(45, '2025-10-03 08:00:00', 13),
(95, '2025-10-03 08:00:00', 14),
(85, '2025-10-03 12:00:00', 14),
(44, '2025-10-03 16:00:00', 14),
(65, '2025-10-03 20:00:00', 14),
(22, '2025-10-04 08:00:00', 14),
(85, '2025-10-04 08:00:00', 15),
(81, '2025-10-04 12:00:00', 15),
(45, '2025-10-04 16:00:00', 15),
(58, '2025-10-04 20:00:00', 15),
(91, '2025-10-05 08:00:00', 15),
(99, '2025-10-05 08:00:00', 16),
(1, '2025-10-05 12:00:00', 16),
(29, '2025-10-05 16:00:00', 16),
(96, '2025-10-05 20:00:00', 16),
(33, '2025-10-06 08:00:00', 16),
(51, '2025-10-06 08:00:00', 17),
(52, '2025-10-06 12:00:00', 17),
(44, '2025-10-06 16:00:00', 17),
(71, '2025-10-06 20:00:00', 17),
(53, '2025-10-07 08:00:00', 17),
(83, '2025-10-07 08:00:00', 18),
(6, '2025-10-07 12:00:00', 18),
(57, '2025-10-07 16:00:00', 18),
(55, '2025-10-07 20:00:00', 18),
(23, '2025-10-08 08:00:00', 18),
(3, '2025-10-08 08:00:00', 19),
(11, '2025-10-08 12:00:00', 19),
(73, '2025-10-08 16:00:00', 19),
(3, '2025-10-08 20:00:00', 19),
(59, '2025-10-09 08:00:00', 19),
(100, '2025-10-09 08:00:00', 20),
(72, '2025-10-09 12:00:00', 20),
(37, '2025-10-09 16:00:00', 20),
(56, '2025-10-09 20:00:00', 20),
(12, '2025-10-10 08:00:00', 20),
(87, '2025-10-10 08:00:00', 21),
(85, '2025-10-10 12:00:00', 21),
(61, '2025-10-10 16:00:00', 21),
(78, '2025-10-10 20:00:00', 21),
(68, '2025-10-11 08:00:00', 21),
(96, '2025-10-11 08:00:00', 22),
(40, '2025-10-11 12:00:00', 22),
(26, '2025-10-11 16:00:00', 22),
(64, '2025-10-11 20:00:00', 22),
(96, '2025-10-12 08:00:00', 22),
(52, '2025-10-12 08:00:00', 23),
(75, '2025-10-12 12:00:00', 23),
(57, '2025-10-12 16:00:00', 23),
(46, '2025-10-12 20:00:00', 23),
(32, '2025-10-13 08:00:00', 23),
(33, '2025-10-13 08:00:00', 24),
(90, '2025-10-13 12:00:00', 24),
(10, '2025-10-13 16:00:00', 24),
(42, '2025-10-13 20:00:00', 24),
(14, '2025-10-14 08:00:00', 24),
(31, '2025-10-14 08:00:00', 25),
(54, '2025-10-14 12:00:00', 25),
(75, '2025-10-14 16:00:00', 25),
(93, '2025-10-14 20:00:00', 25),
(44, '2025-10-15 08:00:00', 25),
(5, '2025-10-15 08:00:00', 26),
(91, '2025-10-15 12:00:00', 26),
(83, '2025-10-15 16:00:00', 26),
(31, '2025-10-15 20:00:00', 26),
(80, '2025-10-16 08:00:00', 26),
(28, '2025-10-16 08:00:00', 27),
(58, '2025-10-16 12:00:00', 27),
(3, '2025-10-16 16:00:00', 27),
(21, '2025-10-16 20:00:00', 27),
(4, '2025-10-17 08:00:00', 27),
(44, '2025-10-17 08:00:00', 28),
(74, '2025-10-17 12:00:00', 28),
(54, '2025-10-17 16:00:00', 28),
(100, '2025-10-17 20:00:00', 28),
(38, '2025-10-18 08:00:00', 28),
(19, '2025-10-18 08:00:00', 29),
(99, '2025-10-18 12:00:00', 29),
(7, '2025-10-18 16:00:00', 29),
(41, '2025-10-18 20:00:00', 29),
(15, '2025-10-19 08:00:00', 29),
(0, '2025-10-19 08:00:00', 30),
(30, '2025-10-19 12:00:00', 30),
(46, '2025-10-19 16:00:00', 30),
(46, '2025-10-19 20:00:00', 30),
(16, '2025-10-20 08:00:00', 30),
(28, '2025-10-20 08:00:00', 31),
(38, '2025-10-20 12:00:00', 31),
(15, '2025-10-20 16:00:00', 31),
(16, '2025-10-20 20:00:00', 31),
(25, '2025-10-21 08:00:00', 31),
(60, '2025-10-21 08:00:00', 32),
(42, '2025-10-21 12:00:00', 32),
(49, '2025-10-21 16:00:00', 32),
(66, '2025-10-21 20:00:00', 32),
(66, '2025-10-22 08:00:00', 32),
(57, '2025-10-22 08:00:00', 33),
(73, '2025-10-22 12:00:00', 33),
(100, '2025-10-22 16:00:00', 33),
(47, '2025-10-22 20:00:00', 33),
(47, '2025-10-23 08:00:00', 33),
(59, '2025-10-23 08:00:00', 34),
(19, '2025-10-23 12:00:00', 34),
(0, '2025-10-23 16:00:00', 34),
(100, '2025-10-23 20:00:00', 34),
(52, '2025-10-24 08:00:00', 34),
(5, '2025-10-24 08:00:00', 35),
(74, '2025-10-24 12:00:00', 35),
(2, '2025-10-24 16:00:00', 35),
(91, '2025-10-24 20:00:00', 35),
(54, '2025-10-25 08:00:00', 35),
(88, '2025-10-25 08:00:00', 36),
(81, '2025-10-25 12:00:00', 36),
(81, '2025-10-25 16:00:00', 36),
(77, '2025-10-25 20:00:00', 36),
(95, '2025-10-26 08:00:00', 36),
(87, '2025-10-26 08:00:00', 37),
(97, '2025-10-26 12:00:00', 37),
(68, '2025-10-26 16:00:00', 37),
(17, '2025-10-26 20:00:00', 37),
(58, '2025-10-27 08:00:00', 37),
(96, '2025-10-27 08:00:00', 38),
(19, '2025-10-27 12:00:00', 38),
(92, '2025-10-27 16:00:00', 38),
(64, '2025-10-27 20:00:00', 38),
(30, '2025-10-28 08:00:00', 38),
(67, '2025-10-28 08:00:00', 39),
(92, '2025-10-28 12:00:00', 39),
(26, '2025-10-28 16:00:00', 39),
(35, '2025-10-28 20:00:00', 39),
(39, '2025-10-29 08:00:00', 39),
(74, '2025-10-29 08:00:00', 40),
(89, '2025-10-29 12:00:00', 40),
(36, '2025-10-29 16:00:00', 40),
(44, '2025-10-29 20:00:00', 40),
(84, '2025-10-30 08:00:00', 40),
(87, '2025-10-30 08:00:00', 41),
(3, '2025-10-30 12:00:00', 41),
(6, '2025-10-30 16:00:00', 41),
(9, '2025-10-30 20:00:00', 41),
(25, '2025-10-31 08:00:00', 41),
(34, '2025-10-31 08:00:00', 42),
(37, '2025-10-31 12:00:00', 42),
(42, '2025-10-31 16:00:00', 42),
(96, '2025-10-31 20:00:00', 42),
(27, '2025-11-01 08:00:00', 42),
(68, '2025-11-01 08:00:00', 43),
(3, '2025-11-01 12:00:00', 43),
(33, '2025-11-01 16:00:00', 43),
(36, '2025-11-01 20:00:00', 43),
(36, '2025-11-02 08:00:00', 43),
(50, '2025-11-02 08:00:00', 44),
(94, '2025-11-02 12:00:00', 44),
(66, '2025-11-02 16:00:00', 44),
(93, '2025-11-02 20:00:00', 44),
(40, '2025-11-03 08:00:00', 44),
(94, '2025-11-03 08:00:00', 45),
(68, '2025-11-03 12:00:00', 45),
(25, '2025-11-03 16:00:00', 45),
(27, '2025-11-03 20:00:00', 45),
(98, '2025-11-04 08:00:00', 45),
(7, '2025-11-04 08:00:00', 46),
(30, '2025-11-04 12:00:00', 46),
(28, '2025-11-04 16:00:00', 46),
(39, '2025-11-04 20:00:00', 46),
(95, '2025-11-05 08:00:00', 46),
(1, '2025-11-05 08:00:00', 47),
(76, '2025-11-05 12:00:00', 47),
(79, '2025-11-05 16:00:00', 47),
(1, '2025-11-05 20:00:00', 47),
(46, '2025-11-06 08:00:00', 47),
(37, '2025-11-06 08:00:00', 48),
(8, '2025-11-06 12:00:00', 48),
(0, '2025-11-06 16:00:00', 48),
(41, '2025-11-06 20:00:00', 48),
(21, '2025-11-07 08:00:00', 48),
(40, '2025-11-07 08:00:00', 49),
(51, '2025-11-07 12:00:00', 49),
(5, '2025-11-07 16:00:00', 49),
(60, '2025-11-07 20:00:00', 49),
(72, '2025-11-08 08:00:00', 49),
(74, '2025-11-08 08:00:00', 50),
(91, '2025-11-08 12:00:00', 50),
(50, '2025-11-08 16:00:00', 50),
(16, '2025-11-08 20:00:00', 50),
(77, '2025-11-09 08:00:00', 50),
(100, '2025-11-09 08:00:00', 51),
(87, '2025-11-09 12:00:00', 51),
(36, '2025-11-09 16:00:00', 51),
(17, '2025-11-09 20:00:00', 51),
(92, '2025-11-10 08:00:00', 51),
(84, '2025-11-10 08:00:00', 52),
(33, '2025-11-10 12:00:00', 52),
(79, '2025-11-10 16:00:00', 52),
(66, '2025-11-10 20:00:00', 52),
(40, '2025-11-11 08:00:00', 52),
(63, '2025-11-11 08:00:00', 53),
(57, '2025-11-11 12:00:00', 53),
(42, '2025-11-11 16:00:00', 53),
(75, '2025-11-11 20:00:00', 53),
(73, '2025-11-12 08:00:00', 53),
(18, '2025-11-12 08:00:00', 54),
(1, '2025-11-12 12:00:00', 54),
(1, '2025-11-12 16:00:00', 54),
(6, '2025-11-12 20:00:00', 54),
(56, '2025-11-13 08:00:00', 54),
(31, '2025-11-13 08:00:00', 55),
(0, '2025-11-13 12:00:00', 55),
(94, '2025-11-13 16:00:00', 55),
(70, '2025-11-13 20:00:00', 55),
(18, '2025-11-14 08:00:00', 55),
(79, '2025-11-14 08:00:00', 56),
(3, '2025-11-14 12:00:00', 56),
(73, '2025-11-14 16:00:00', 56),
(41, '2025-11-14 20:00:00', 56),
(12, '2025-11-15 08:00:00', 56);
select nomeFantasia as Facility, 
  nome as Funcionario, 
  email as 'E-mail', 
  telefone as Contato 
from Facility join Funcionario on idFacility = fkFacility;

select fy.nomeFantasia as Facility,
  e.nomeFantasia as 'Contratante Facility',
  fl.titulo as 'Filial a prestar serviço'
from Facility as fy join Empresa as e on idFacility = fkFacility join Filial as fl on fkEmpresa = idEmpresa;

select titulo, concat(logradouro, ' ', numero, ' - CEP: ', cep) as Endereço from Filial join Endereco on fkFilial = idFilial;

select Filial.titulo as 'Empresa contratante',
  b.titulo as 'Cabine sanitária', 
  identificacao as Dispenser, 
  valor as 'Percentual de consumo', 
  dtRegistro as 'Data de registro' 
from Registro join Dispenser on fkDispenser = idDispenser
    join Banheiro as b on fkBanheiro = idBanheiro
    join Filial on fkfilial = idFilial
    join Empresa on fkEmpresa = idEmpresa
    join Facility on fkFacility = idFacility
  where Facility.nomeFantasia = 'Felicity em te ajudar'